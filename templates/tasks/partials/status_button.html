{% if can_change_status %}
    {% with next_status=task.get_next_status %}
    {% if next_status %}
    <form method="post" 
          action="{% url 'tasks:quick_status_change' task.pk %}"
          hx-post="{% url 'tasks:quick_status_change' task.pk %}"
          hx-swap="outerHTML"
          class="inline">
        {% csrf_token %}
        <button type="submit" 
                class="inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded shadow-sm text-white 
                {% if next_status == 'in_progress' %}bg-blue-600 hover:bg-blue-700
                {% elif next_status == 'completed' %}bg-green-600 hover:bg-green-700
                {% elif next_status == 'verified' %}bg-indigo-600 hover:bg-indigo-700
                {% else %}bg-gray-600 hover:bg-gray-700{% endif %}">
            {% if next_status == 'in_progress' %}
            Start Working
            {% elif next_status == 'completed' %}
            Mark Complete
            {% elif next_status == 'verified' %}
            Verify
            {% endif %}
        </button>
    </form>
    {% else %}
    <span class="inline-flex items-center px-3 py-1.5 text-xs font-medium text-gray-500">
        {% if task.status == 'verified' %}✓ Verified
        {% elif task.status == 'cancelled' %}Cancelled
        {% elif task.status == 'completed' and task.is_personal %}✓ Completed
        {% endif %}
    </span>
    {% endif %}
    {% endwith %}
{% else %}
<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
    {% if task.status == 'pending' %}bg-yellow-100 text-yellow-800
    {% elif task.status == 'in_progress' %}bg-blue-100 text-blue-800
    {% elif task.status == 'completed' %}bg-green-100 text-green-800
    {% elif task.status == 'verified' %}bg-green-200 text-green-900
    {% else %}bg-gray-100 text-gray-800{% endif %}">
    {{ task.get_status_display }}
</span>
{% endif %}
